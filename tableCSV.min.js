var tableCSV=function(){var v=[];var h="";function e(e){for(var n=0;n<e.children.length;n++){var r=e.children[n];if(r.nodeName=="THEAD"||r.nodeName=="TBODY"||r.nodeName=="TFOOT"){for(var t=0;t<r.children.length;t++){var a=r.children[t];if(a.nodeName=="TR"){var o=[];for(var i=0;i<a.children.length;i++){var d=a.children[i];if(d.nodeName=="TH"||d.nodeName=="TD"){o.push(f(d.innerText))}}v.push(o.join(","))}}}else{if(r.nodeName=="TR"){var c=[];for(var t=0;t<r.children.length;t++){var l=r.children[t];if(l.nodeName=="TH"||l.nodeName=="TD"){c.push(f(l.innerText))}}v.push(c.join(","))}}}h=v.join("\n")}function f(e){var n=e.replace(/"/g,'""');if(n.search(/("|,|\n)/g)>=0)n='"'+n+'"';return n}e.prototype.toCSVText=function(){return h};e.prototype.saveCSV=function(e){var n=new Blob([h],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob){navigator.msSaveBlob(n,e+".csv")}else{var r=document.createElement("a");if(r.download!==undefined){var t=URL.createObjectURL(n);r.setAttribute("href",t);r.setAttribute("download",e+".csv");r.style.visibility="hidden";document.body.appendChild(r);r.click();document.body.removeChild(r)}}return};return e}();
